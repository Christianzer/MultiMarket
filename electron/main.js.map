{"version":3,"file":"main.js","sources":["main.ts"],"sourcesContent":["import { app, BrowserWindow, shell, ipcMain } from 'electron'\r\nimport pkg from 'electron-updater'\r\nconst { autoUpdater } = pkg\r\nimport { createRequire } from 'node:module'\r\nimport { fileURLToPath } from 'node:url'\r\nimport path from 'node:path'\r\n\r\nconst require = createRequire(import.meta.url)\r\nconst __dirname = path.dirname(fileURLToPath(import.meta.url))\r\n\r\n// The built directory structure\r\n//\r\n// ├─┬─┬ dist\r\n// │ │ └── index.html\r\n// │ │\r\n// │ ├─┬ electron\r\n// │ │ ├── main.ts\r\n// │ │ └── preload.ts\r\n// │\r\nprocess.env.APP_ROOT = path.join(__dirname, '..')\r\n\r\nexport const VITE_DEV_SERVER_URL = process.env.VITE_DEV_SERVER_URL\r\nexport const MAIN_DIST = path.join(process.env.APP_ROOT, 'electron')\r\nexport const RENDERER_DIST = path.join(process.env.APP_ROOT, 'dist')\r\n\r\nprocess.env.VITE_PUBLIC = VITE_DEV_SERVER_URL ? path.join(process.env.APP_ROOT, 'public') : RENDERER_DIST\r\n\r\nlet win: BrowserWindow | null\r\n\r\nfunction createWindow() {\r\n  win = new BrowserWindow({\r\n    width: 1200,\r\n    height: 800,\r\n    minWidth: 800,\r\n    minHeight: 600,\r\n    icon: path.join(process.env.APP_ROOT, 'build', 'icon.ico'),\r\n    autoHideMenuBar: true,\r\n    webPreferences: {\r\n      preload: path.join(__dirname, 'preload.js'),\r\n      nodeIntegration: false,\r\n      contextIsolation: true,\r\n    },\r\n  })\r\n\r\n  // Test active push message to Renderer-process.\r\n  win.webContents.on('did-finish-load', () => {\r\n    win?.webContents.send('main-process-message', new Date().toLocaleString())\r\n  })\r\n\r\n  if (VITE_DEV_SERVER_URL) {\r\n    win.loadURL(VITE_DEV_SERVER_URL)\r\n    win.webContents.openDevTools()\r\n  } else {\r\n    // win.loadFile('dist/index.html')\r\n    win.loadFile(path.join(RENDERER_DIST, 'index.html'))\r\n  }\r\n\r\n  // Make all links open with the browser, not with the application\r\n  win.webContents.setWindowOpenHandler(({ url }) => {\r\n    if (url.startsWith('https:')) shell.openExternal(url)\r\n    return { action: 'deny' }\r\n  })\r\n}\r\n\r\n// Configure auto-updater with proper error handling\r\nfunction setupAutoUpdater() {\r\n  // Only enable auto-updater in production builds\r\n  if (process.env.NODE_ENV === 'production' && !process.env.VITE_DEV_SERVER_URL) {\r\n    console.log('Setting up auto-updater for production...')\r\n    \r\n    // Configure auto-updater settings\r\n    autoUpdater.logger = console\r\n    autoUpdater.checkForUpdatesAndNotify = true\r\n    \r\n    // Auto-updater event listeners with proper error handling\r\n    autoUpdater.on('checking-for-update', () => {\r\n      console.log('Checking for update...')\r\n      // Notify renderer process\r\n      win?.webContents.send('updater-message', 'Vérification des mises à jour...')\r\n    })\r\n\r\n    autoUpdater.on('update-available', (info) => {\r\n      console.log('Update available:', info)\r\n      win?.webContents.send('updater-message', 'Une mise à jour est disponible, veuillez mettre à jour l\\'application et redémarrer')\r\n    })\r\n\r\n    autoUpdater.on('update-not-available', (info) => {\r\n      console.log('Update not available:', info)\r\n      win?.webContents.send('updater-message', 'Aucune mise à jour disponible')\r\n    })\r\n\r\n    autoUpdater.on('error', (err) => {\r\n      console.log('Error in auto-updater:', err)\r\n      // Don't crash the app on updater errors, just log them\r\n      win?.webContents.send('updater-error', `Erreur de mise à jour: ${err.message}`)\r\n    })\r\n\r\n    autoUpdater.on('download-progress', (progressObj) => {\r\n      let log_message = `Vitesse: ${Math.round(progressObj.bytesPerSecond / 1024)} KB/s`\r\n      log_message += ` - Téléchargé ${Math.round(progressObj.percent)}%`\r\n      log_message += ` (${Math.round(progressObj.transferred / 1024 / 1024)} MB / ${Math.round(progressObj.total / 1024 / 1024)} MB)`\r\n      console.log(log_message)\r\n      \r\n      // Notify renderer process of download progress\r\n      win?.webContents.send('updater-progress', {\r\n        percent: Math.round(progressObj.percent),\r\n        transferred: Math.round(progressObj.transferred / 1024 / 1024),\r\n        total: Math.round(progressObj.total / 1024 / 1024),\r\n        speed: Math.round(progressObj.bytesPerSecond / 1024)\r\n      })\r\n    })\r\n\r\n    autoUpdater.on('update-downloaded', (info) => {\r\n      console.log('Update downloaded:', info)\r\n      win?.webContents.send('updater-message', 'Mise à jour téléchargée. L\\'application va redémarrer automatiquement dans quelques secondes...')\r\n      \r\n      // Give user a few seconds to see the message before restarting\r\n      setTimeout(() => {\r\n        autoUpdater.quitAndInstall()\r\n      }, 5000)\r\n    })\r\n\r\n    // Check for updates with error handling\r\n    setTimeout(() => {\r\n      autoUpdater.checkForUpdatesAndNotify().catch(err => {\r\n        console.log('Auto-updater check failed:', err.message)\r\n        win?.webContents.send('updater-error', `Impossible de vérifier les mises à jour: ${err.message}`)\r\n      })\r\n    }, 5000) // Wait 5 seconds after app start\r\n    \r\n  } else {\r\n    console.log('Auto-updater disabled in development mode')\r\n  }\r\n}\r\n\r\n// This method will be called when Electron has finished\r\n// initialization and is ready to create browser windows.\r\n// Some APIs can only be used after this event occurs.\r\napp.whenReady().then(() => {\r\n  createWindow()\r\n  \r\n  // Setup auto-updater with proper error handling\r\n  setupAutoUpdater()\r\n})\r\n\r\n// Quit when all windows are closed, except on macOS. There, it's common\r\n// for applications and their menu bar to stay active until the user quits\r\n// explicitly with Cmd + Q.\r\napp.on('window-all-closed', () => {\r\n  if (process.platform !== 'darwin') {\r\n    app.quit()\r\n  }\r\n})\r\n\r\napp.on('activate', () => {\r\n  // On OS X it's common to re-create a window in the app when the\r\n  // dock icon is clicked and there are no other windows open.\r\n  if (BrowserWindow.getAllWindows().length === 0) {\r\n    createWindow()\r\n  }\r\n})\r\n\r\n// In this file you can include the rest of your app's specific main process\r\n// code. You can also put them in separate files and require them here.\r\n\r\n// --------- IPC Handlers for Printing and Window Controls ---------\r\n\r\n// Gestionnaire pour l'impression de reçus POS\r\nipcMain.handle('print-receipt', async (event, htmlContent: string) => {\r\n  try {\r\n    // Créer une fenêtre cachée pour l'impression POS\r\n    const printWindow = new BrowserWindow({\r\n      width: 300, // Largeur exacte pour imprimante POS 80mm\r\n      height: 800, // Hauteur plus grande pour les longs reçus\r\n      show: false, // En développement, mettre à true pour déboguer\r\n      webPreferences: {\r\n        nodeIntegration: false,\r\n        contextIsolation: true\r\n      }\r\n    })\r\n\r\n    // Charger le contenu HTML\r\n    await printWindow.loadURL(`data:text/html;charset=utf-8,${encodeURIComponent(htmlContent)}`)\r\n\r\n    // Attendre que le contenu soit complètement chargé et rendu\r\n    await new Promise(resolve => {\r\n      printWindow.webContents.once('did-finish-load', () => {\r\n        // Attendre un peu plus pour s'assurer que le CSS est appliqué\r\n        setTimeout(resolve, 500)\r\n      })\r\n    })\r\n\r\n    // Options d'impression optimisées pour imprimantes POS\r\n    const printOptions: any = {\r\n      silent: true, // Impression silencieuse sans dialogue\r\n      printBackground: true, // Inclure les arrière-plans\r\n      color: false, // Impression en noir et blanc pour POS\r\n      margins: {\r\n        marginType: 'custom' as const,\r\n        top: 0,    // Pas de marge haute\r\n        bottom: 0, // Pas de marge basse  \r\n        left: 0,   // Pas de marge gauche\r\n        right: 0   // Pas de marge droite\r\n      },\r\n      pageSize: {\r\n        width: 79000,  // 79mm en microns (légèrement moins que 80mm pour éviter la coupure)\r\n        height: 297000 // Hauteur variable automatique (A4 = 297mm, sera ajustée automatiquement)\r\n      },\r\n      scaleFactor: 100, // Échelle 100% pour taille réelle\r\n      landscape: false, // Portrait pour reçu\r\n      copies: 1,        // Une seule copie\r\n      pageRanges: {},   // Toutes les pages\r\n      duplexMode: 'simplex', // Impression simple face\r\n      collate: true,\r\n      // Paramètres spécifiques POS\r\n      headerFooter: false, // Pas d'en-tête/pied de page automatique\r\n      shouldPrintBackgrounds: true,\r\n      shouldPrintSelectionOnly: false\r\n    }\r\n\r\n    // Utiliser l'imprimante sélectionnée si disponible\r\n    if (selectedPrinter) {\r\n      printOptions.deviceName = selectedPrinter\r\n      console.log('Impression vers:', selectedPrinter)\r\n    } else {\r\n      console.log('Aucune imprimante POS sélectionnée, utilisation de l\\'imprimante par défaut')\r\n    }\r\n\r\n    // Imprimer avec gestion d'erreur améliorée\r\n    const result = await printWindow.webContents.print(printOptions)\r\n    \r\n    // Log pour déboguer en développement\r\n    console.log('Impression POS:', result ? 'Réussie' : 'Échouée ou Annulée')\r\n    \r\n    // Fermer la fenêtre d'impression après un délai\r\n    setTimeout(() => {\r\n      if (!printWindow.isDestroyed()) {\r\n        printWindow.close()\r\n      }\r\n    }, 2000) // Délai plus long pour s'assurer que l'impression est terminée\r\n    \r\n    return { \r\n      success: true, \r\n      printed: result,\r\n      message: result ? 'Reçu imprimé avec succès' : 'Impression annulée ou échouée'\r\n    }\r\n  } catch (error) {\r\n    console.error('Erreur lors de l\\'impression POS:', error)\r\n    return { \r\n      success: false, \r\n      error: (error as Error).message,\r\n      message: 'Erreur d\\'impression - Vérifiez que l\\'imprimante POS est connectée'\r\n    }\r\n  }\r\n})\r\n\r\n// Gestionnaire pour ouvrir les DevTools\r\nipcMain.handle('open-dev-tools', () => {\r\n  if (win) {\r\n    win.webContents.openDevTools()\r\n  }\r\n})\r\n\r\n// Gestionnaires pour les contrôles de fenêtre\r\nipcMain.handle('window-minimize', () => {\r\n  if (win) {\r\n    win.minimize()\r\n  }\r\n})\r\n\r\nipcMain.handle('window-maximize', () => {\r\n  if (win) {\r\n    if (win.isMaximized()) {\r\n      win.unmaximize()\r\n    } else {\r\n      win.maximize()\r\n    }\r\n  }\r\n})\r\n\r\nipcMain.handle('window-close', () => {\r\n  if (win) {\r\n    win.close()\r\n  }\r\n})\r\n\r\n// Variables pour gérer l'imprimante POS sélectionnée\r\nlet selectedPrinter: string | null = null\r\n\r\n// Gestionnaire pour lister les imprimantes disponibles\r\nipcMain.handle('get-printers', async () => {\r\n  try {\r\n    if (win) {\r\n      const printers = await win.webContents.getPrintersAsync()\r\n      \r\n      // Filtrer et identifier les imprimantes POS probables\r\n      const posKeywords = ['pos', 'thermal', 'receipt', 'tm', 'epson', 'star', 'citizen', 'bixolon', 'zebra', 'esc']\r\n      \r\n      const printersWithType = printers.map(printer => ({\r\n        ...printer,\r\n        isPOS: posKeywords.some(keyword => \r\n          printer.name.toLowerCase().includes(keyword) || \r\n          printer.description?.toLowerCase().includes(keyword)\r\n        )\r\n      }))\r\n      \r\n      console.log('Imprimantes détectées:', printersWithType.length)\r\n      printersWithType.forEach(p => {\r\n        console.log(`- ${p.name} ${p.isPOS ? '(POS)' : '(Standard)'}: ${p.description}`)\r\n      })\r\n      \r\n      return {\r\n        success: true,\r\n        printers: printersWithType,\r\n        selectedPrinter\r\n      }\r\n    }\r\n    return { success: false, error: 'Fenêtre non disponible' }\r\n  } catch (error) {\r\n    console.error('Erreur lors de la récupération des imprimantes:', error)\r\n    return { \r\n      success: false, \r\n      error: (error as Error).message,\r\n      printers: []\r\n    }\r\n  }\r\n})\r\n\r\n// Gestionnaire pour définir l'imprimante POS à utiliser\r\nipcMain.handle('set-printer', async (event, printerName: string) => {\r\n  try {\r\n    selectedPrinter = printerName\r\n    console.log('Imprimante POS sélectionnée:', printerName)\r\n    return { success: true, printer: printerName }\r\n  } catch (error) {\r\n    console.error('Erreur lors de la sélection de l\\'imprimante:', error)\r\n    return { success: false, error: (error as Error).message }\r\n  }\r\n})\r\n\r\n// IPC handlers for auto-updater\r\nipcMain.handle('check-for-updates', async () => {\r\n  try {\r\n    if (process.env.NODE_ENV === 'production' && !process.env.VITE_DEV_SERVER_URL) {\r\n      console.log('Manual update check requested')\r\n      const result = await autoUpdater.checkForUpdatesAndNotify()\r\n      return { success: true, result }\r\n    } else {\r\n      return { success: false, error: 'Auto-updater is disabled in development mode' }\r\n    }\r\n  } catch (error) {\r\n    console.error('Error checking for updates:', error)\r\n    return { success: false, error: (error as Error).message }\r\n  }\r\n})\r\n\r\nipcMain.handle('quit-and-install', () => {\r\n  try {\r\n    console.log('Quit and install requested')\r\n    autoUpdater.quitAndInstall()\r\n    return { success: true }\r\n  } catch (error) {\r\n    console.error('Error during quit and install:', error)\r\n    return { success: false, error: (error as Error).message }\r\n  }\r\n})\r\n\r\n// Additional IPC handlers for updater info\r\nipcMain.handle('get-app-version', () => {\r\n  return app.getVersion()\r\n})\r\n\r\nipcMain.handle('restart-app', () => {\r\n  app.relaunch()\r\n  app.exit()\r\n})"],"names":[],"mappings":"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"}